function getMaxZindex(e){return Math.max.apply(null,$(e).map(function(){var e;return isNaN(e=parseInt($(this).css("z-index"),10))?0:e}))}function addBlock(o){var e=jQuery("#bgcontainer"+o+" .element");if(e.length<=10){console.log("Adding block!");var i="#"+Math.floor(16777215*Math.random()).toString(16),t=[5,20,30,40,50,60,70,80,90],r=t[Math.floor(Math.random()*t.length)],n=getMaxZindex(e)+1;jQuery.ajax({url:setting_apiUrl+"/?page=addblock",method:"POST",data:{id_slide:o,color:i,pos:r,zindex:n},success:function(a,e,t){console.log(JSON.parse(a)[0]),console.log(e),console.log(t),jQuery("ol li .badge-secondary").removeClass("disabled"),jQuery("#bgcontainer"+o).append('<div id="blockcontainer'+JSON.parse(a)[0]+'" class="blockcontainer element" style="position: absolute; left: '+r+"px; top: "+r+"px; z-index: "+n+"; width: 100px; height: 100px; background-color: "+i+';"></div>'),jQuery("#blockcontainer"+JSON.parse(a)[0]).draggable({cursor:"move",stop:function(){var e=jQuery(this).css("left"),t=jQuery(this).css("top"),o=jQuery(this).attr("data-el");jQuery.ajax({url:setting_apiUrl+"/?page=updateblockpos",method:"POST",data:{id_block:o,x:e,y:t},success:function(){console.log("Position of block updated!")},error:function(){console.log("Something went wrong! Please contact with admin.")}})}}),jQuery(function(){var e,t=JSON.parse(a)[0];function n(e){jQuery(".dialogBlock"+t+" .validateTips").html(e).addClass("ui-state-highlight"),setTimeout(function(){jQuery(".dialogBlock"+t+" .validateTips").removeClass("ui-state-highlight",500)},500)}function o(e,t){var o=!0;if(jQuery("#text"+e+",  #zindexBlock"+e).removeClass("ui-state-error"),(jQuery("#height"+e).val()<100||1e3<jQuery("#height"+e).val())&&(o=!1,jQuery("#height"+e).addClass("ui-state-error"),n("Block's height must be from 5px to 5000px!")),(jQuery("#width"+e).val()<5||5e3<jQuery("#width"+e).val())&&(o=!1,jQuery("#width"+e).addClass("ui-state-error"),n("Block's width must be from 5px to 5000px!")),isNaN(jQuery("#zindexBlock"+e).val())&&(o=!1,jQuery("#zindexBlock"+e).addClass("ui-state-error"),n("Wage must be a number!")),o){var a=jQuery("#height"+e).val(),i=jQuery("#width"+e).val(),r=jQuery("#zindexBlock"+e).val();jQuery.ajax({url:setting_apiUrl+"/?page=updateblock",method:"POST",data:{id_block:e,height:a,width:i,zindex:r},success:function(){console.log("Block updated!"),jQuery("#blockcontainer"+e).css("height",a),jQuery("#blockcontainer"+e).css("width",i),jQuery("#blockcontainer"+e).css("z-index",r),t.dialog("close")},error:function(){n("Something went wrong! Please contact with admin.")}})}return o}(e=jQuery("#dialogBlock"+t).dialog({autoOpen:!1,height:400,width:350,modal:!0,buttons:{"Save in database":function(){o(t,e)},Cancel:function(){e.dialog("close")}},close:function(){jQuery(".validateTips").removeClass("ui-state-error")}})).dialog("close"),e.css("display","block"),e.find("form.dialogForm").on("submit",function(e){e.preventDefault(),o(t)}),jQuery("#dialogBlock"+t).on("click",function(){e.dialog("open"),console.log(t)})}),jQuery("#elements"+o).append('<li class="element'+JSON.parse(a)[0]+' Block ?> list-group-item d-flex justify-content-between align-items-center">   Block #'+JSON.parse(a)[0]+'   <div class="badges">       <span class="badge badge-danger badge-pill">DELETE</span>   </div></li>')},error:function(e,t,o){console.log(e.responseText),console.log(e.statusText),console.log(t),console.log(o)}})}else jQuery("#addText"+o).addClass("disabled"),alert("You can only add 10 elements to one slide!")}function addText(o){var e=jQuery("#bgcontainer"+o+" .element");if(e.length<=10){console.log("Adding text!");var t=[5,20,30,40,50,60,70,80,90],i=t[Math.floor(Math.random()*t.length)],r=getMaxZindex(e)+1;jQuery.ajax({url:setting_apiUrl+"/?page=addtext",method:"POST",data:{id_slide:o,pos:i,zindex:r},success:function(a,e,t){console.log(JSON.parse(a)[0]),console.log(e),console.log(t),jQuery("ol li .badge-secondary").removeClass("disabled"),jQuery("#bgcontainer"+o).append('<div id="textcontainer'+JSON.parse(a)[0]+' " class="textcontainer element" style="position: absolute; left: '+i+"px; top: "+i+"px; z-index: "+r+'"><p>Hello world</p></div></div>'),jQuery("#textcontainer"+JSON.parse(a)[0]).draggable({cursor:"move",stop:function(){var e=jQuery(this).css("left"),t=jQuery(this).css("top"),o=jQuery(this).attr("data-el");jQuery.ajax({url:setting_apiUrl+"/?page=updatetextpos",method:"POST",data:{id_text:o,x:e,y:t},success:function(){console.log("Position of block updated!")},error:function(){console.log("Something went wrong! Please contact with admin.")}})}}),jQuery(function(){function r(e){jQuery(".dialogText"+o+" .validateTips").html(e).addClass("ui-state-highlight"),setTimeout(function(){jQuery(".dialogText"+o+" .validateTips").removeClass("ui-state-highlight",500)},500)}function t(e,t){var o=!0;if(jQuery("#text"+e+",  #zindexText"+e).removeClass("ui-state-error"),jQuery("#text"+e).val().includes("<script>")&&(o=!1,jQuery("#text"+e).addClass("ui-state-error"),r("Do not try to put scripts!")),isNaN(jQuery("#zindexText"+e).val())&&(o=!1,jQuery("#zindex"+e).addClass("ui-state-error"),r("Wage must be a number!")),o){var a=jQuery("#text"+e).val(),i=jQuery("#zindexText"+e).val();jQuery.ajax({url:setting_apiUrl+"/?page=updatetext",method:"POST",data:{id_text:e,text:a,zindex:i},success:function(){console.log("Text updated!"),jQuery("#textcontainer"+e).html(a),jQuery("#textcontainer"+e).css("z-index",i),t.dialog("close")},error:function(){r("Something went wrong! Please contact with admin.")}})}return o}var o=JSON.parse(a)[0],e=jQuery("#dialogText"+o).dialog({autoOpen:!1,height:400,width:350,modal:!0,buttons:{"Save in database":function(){t(o,e)},Cancel:function(){e.dialog("close")}},close:function(){jQuery(".validateTips").removeClass("ui-state-error")}});e.dialog("close"),e.css("display","block"),e.find("form.dialogForm").on("submit",function(e){e.preventDefault(),t(o)}),jQuery("#dialogText"+o).on("click",function(){e.dialog("open"),console.log(o)})}),jQuery("#elements"+o).append('<li class="element'+JSON.parse(a)[0]+' Text ?> list-group-item d-flex justify-content-between align-items-center">   Text #'+JSON.parse(a)[0]+'   <div class="badges">       <span class="badge badge-danger badge-pill">DELETE</span>   </div></li>')},error:function(e,t,o){console.log(e.responseText),console.log(e.statusText),console.log(t),console.log(o)}})}else jQuery("#addText"+o).addClass("disabled"),alert("You can only add 10 elements to one slide!")}function updateSliderDB(){var e=jQuery("#sliderHeight").val(),t=jQuery("#sliderSpeed").val(),o=jQuery("#sliderName").val();jQuery(".errors").empty(),e<100||1e3<e?jQuery(".errors").append("<h5 class='error'>Wrong height, 100px-1000px</h5>"):/[^A-Z a-z0-9]/.test(o)?jQuery(".errors").append("<h5 class='error'>Wrong name, only letters, spaces nad numbers</h5>"):2e4<t||t<500?jQuery(".errors").append("<h5 class='error'>Wrong speed, 500ms-20000ms</h5>"):jQuery.ajax({url:setting_apiUrl+"/?page=updateslider",method:"POST",data:{height:e,speed:t,name:o},success:function(){console.log("Slider updated!"),jQuery("#sliderHeader").html(jQuery("#sliderName").val()),jQuery(".bgcontainer").css("height",e+"px"),jQuery("#saveSlider").removeClass("btn-danger").addClass("btn-success")},error:function(){console.log("Error! Slider not updated!")}})}jQuery(document).ready(function(){jQuery("#sliderSpeed").change(function(){jQuery("label[for='sliderSpeed']").html("Speed ("+jQuery("#sliderSpeed").val()+" ms)")})}),jQuery(document).ready(function(){jQuery("ol li:nth-child(1) .badge-primary").addClass("disabled"),jQuery("ol li:nth-last-child(1) .badge-secondary").addClass("disabled"),jQuery(".textcontainer").draggable({cursor:"move",stop:function(){var e=jQuery(this).css("left"),t=jQuery(this).css("top"),o=jQuery(this).attr("data-el");jQuery.ajax({url:setting_apiUrl+"/?page=updatetextpos",method:"POST",data:{id_text:o,x:e,y:t},success:function(){console.log("Position of block updated!")},error:function(){console.log("Something went wrong! Please contact with admin.")}})}}),jQuery(".blockcontainer").draggable({cursor:"move",stop:function(){var e=jQuery(this).css("left"),t=jQuery(this).css("top"),o=jQuery(this).attr("data-el");jQuery.ajax({url:setting_apiUrl+"/?page=updateblockpos",method:"POST",data:{id_block:o,x:e,y:t},success:function(){console.log("Position of block updated!")},error:function(){console.log("Something went wrong! Please contact with admin.")}})}}),jQuery(function(){function r(e){jQuery(".dialogText"+id+" .validateTips").html(e).addClass("ui-state-highlight"),setTimeout(function(){jQuery(".dialogText"+id+" .validateTips").removeClass("ui-state-highlight",500)},500)}function a(e,t){var o=!0;if(jQuery("#text"+e+",  #zindexText"+e).removeClass("ui-state-error"),jQuery("#text"+e).val().includes("<script>")&&(o=!1,jQuery("#text"+e).addClass("ui-state-error"),r("Do not try to put scripts!")),isNaN(jQuery("#zindexText"+e).val())&&(o=!1,jQuery("#zindex"+e).addClass("ui-state-error"),r("Wage must be a number!")),o){var a=jQuery("#text"+e).val(),i=jQuery("#zindexText"+e).val();jQuery.ajax({url:setting_apiUrl+"/?page=updatetext",method:"POST",data:{id_text:e,text:a,zindex:i},success:function(){console.log("Text updated!"),jQuery("#textcontainer"+e).html(a),jQuery("#textcontainer"+e).css("z-index",i),t.dialog("close")},error:function(){r("Something went wrong! Please contact with admin.")}})}return o}jQuery(".textcontainer").each(function(e){var t=jQuery(this).attr("data-el"),o=jQuery("#dialogText"+t).dialog({autoOpen:!1,height:400,width:350,modal:!0,buttons:{"Save in database":function(){a(t,o)},Cancel:function(){o.dialog("close")}},close:function(){jQuery(".validateTips").removeClass("ui-state-error")}});o.dialog("close"),o.css("display","block"),o.find("form.dialogForm").on("submit",function(e){e.preventDefault(),a(t)}),jQuery(this).on("click",function(){o.dialog("open"),console.log(t)})})}),jQuery(function(){function n(e){jQuery(".dialogBlock"+id+" .validateTips").html(e).addClass("ui-state-highlight"),setTimeout(function(){jQuery(".dialogBlock"+id+" .validateTips").removeClass("ui-state-highlight",500)},500)}function a(e,t){var o=!0;if(jQuery("#text"+e+",  #zindexBlock"+e).removeClass("ui-state-error"),(jQuery("#height"+e).val()<100||1e3<jQuery("#height"+e).val())&&(o=!1,jQuery("#height"+e).addClass("ui-state-error"),n("Block's height must be from 5px to 5000px!")),(jQuery("#width"+e).val()<5||5e3<jQuery("#width"+e).val())&&(o=!1,jQuery("#width"+e).addClass("ui-state-error"),n("Block's width must be from 5px to 5000px!")),isNaN(jQuery("#zindexBlock"+e).val())&&(o=!1,jQuery("#zindexBlock"+e).addClass("ui-state-error"),n("Wage must be a number!")),o){var a=jQuery("#height"+e).val(),i=jQuery("#width"+e).val(),r=jQuery("#zindexBlock"+e).val();jQuery.ajax({url:setting_apiUrl+"/?page=updateblock",method:"POST",data:{id_block:e,height:a,width:i,zindex:r},success:function(){console.log("Block updated!"),jQuery("#blockcontainer"+e).css("height",a),jQuery("#blockcontainer"+e).css("width",i),jQuery("#blockcontainer"+e).css("z-index",r),t.dialog("close")},error:function(){n("Something went wrong! Please contact with admin.")}})}return o}jQuery(".blockcontainer").each(function(e){var t=jQuery(this).attr("data-el"),o=jQuery("#dialogBlock"+t).dialog({autoOpen:!1,height:400,width:350,modal:!0,buttons:{"Save in database":function(){a(t,o)},Cancel:function(){o.dialog("close")}},close:function(){jQuery(".validateTips").removeClass("ui-state-error")}});o.dialog("close"),o.css("display","block"),o.find("form.dialogForm").on("submit",function(e){e.preventDefault(),a(t)}),jQuery(this).on("click",function(){o.dialog("open"),console.log(t)})})})}),jQuery(document).ready(function(){jQuery("#saveSlider").click(function(){console.log("Updating slider..."),updateSliderDB()}),jQuery("#sliderName, #sliderSpeed, #sliderHeight").change(function(){jQuery("#saveSlider").removeClass("btn-success").addClass("btn-danger")})});